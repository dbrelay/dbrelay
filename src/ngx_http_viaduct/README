Compile instructions
--------------------

These are temporary instructions for compiling viaduct.  Eventually there will be a master build process using autoconf 
or something similar.  

These instructions assume the following directories, adjust as necessary

freetds is unpacked in ~/src/freetds-0.82
freetds is installed in ~/freetds-0.82
viaduct module is unpacked in ~/src/ngx_http_viaduct
nginx is unpacked in ~/src/nginx-0.7.11

Viaduct needs two static libraries from FreeTDS.  The libtds.a is only available internally and needs
to be copied from the source directory and not the installed directory.

cp ~/freetds-0.82/src/dblib/.libs/libsybdb.a ~/src/ngx_http_viaduct/lib
cp ~/freetds-0.82/src/tds/.libs/libtds.a ~/src/ngx_http_viaduct/lib

Next, build nginx with the following options.  --without-http_rewrite_module is necassary only
on OSX without PCRE loaded, this will be resolved in the future

cd ~/nginx-0.7.11
./configure --prefix=/Users/devapp/nginx-0.7.11 --without-http_rewrite_module --add-module=/Users/devapp/src/ngx_http_viaduct
make
make install

Configuration
-------------

The following lines must be added to the nginx.conf file's "server" section.

location /sql {
   viaduct;
}

change the listen port and other options changed if needed.


Running
-------

To start: sbin/nginx
To stop: kill `cat logs/nginx.pid`


Testing
-------

To automatically test viaduct edit unittest/telnet.py to suitable values and run:

python telnet.py

To test in the web browser, 

cp ~/src/ngx_http_viaduct/unittest/example.html ~/nginx-0.7.11/html

and navigate to "http://localhost:8080/example.html" (assuming nginx configured on localhost:8080)

